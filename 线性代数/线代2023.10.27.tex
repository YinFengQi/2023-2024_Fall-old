% !TeX root = 线性代数.tex

\subsection{相似对角化}
我们之前讨论的把矩阵变为``标准形式''有
\begin{itemize}
    \item 行变换$\longrightarrow$行约化阶梯形.
    \item 行变换, 对于可逆矩阵 $A = LDU$.
    \item 正交对角化, 对于可逆矩阵 $A = QR$.
\end{itemize}

一般来说, 行变换是改变特征值的, 对于$A x = \lambda x$, 它的初等变换
\begin{equation}
  A' = EA
\end{equation}
原本的$\lambda$不是$A'$的特征值.

我们引进一种保持特征值的变换: 相似变换.
\begin{definition}
    对于一个矩阵$A$, 它的相似变换为$C = P^{-1} A P$, 其中$P$为可逆矩阵.
\end{definition}

\begin{proposition}
    在相似变换下, 矩阵的特征值不变.
\end{proposition}
\begin{proof}
    假设$\lambda$是$A$的特征值, 特征向量为$x$, 有$A x = \lambda x$. 对于$C = P ^{-1}A P$, 有
    \begin{equation}
      C \left( P ^{-1} x \right) = \left( P ^{-1}AP \right) P ^{-1}x = P ^{-1} A x = P ^{-1} \lambda x = \lambda \left( P ^{-1} x \right). 
    \end{equation}
    并且$P ^{-1}x$为非零向量.

    反之, 对于$C$的一个特征值$\lambda$及对应的特征向量$x$, $Cx=\lambda x$, 有
    \begin{equation}
      A \left( Px \right) = P C P ^{-1} \left( Px \right)  = P C x = P \lambda x = \lambda \left( P x \right).
    \end{equation}
\end{proof}

\begin{proposition}
    $A$的特征多项式和$C$的特征多项式是一样的.
\end{proposition}
\begin{proof}
    我们有$P_{A}\left( \lambda \right) = \det \left( \lambda I - A \right) $.

    对于$C = P ^{-1} A P$, 有
    \begin{equation} 
      \begin{aligned}
        P_{C} \left( \lambda \right) 
        & = \det \left( \lambda I - P ^{-1} A P \right) = \det \left( \lambda P ^{-1} P - P ^{-1} A P \right)
        \\
        & = \det \left( P ^{-1} \left( \lambda I - A \right) P \right) 
        \\
        & = \det \left( P ^{-1} \right) \det \left( \lambda I - A \right) \det \left( P \right) 
        \\
        & = \det \left( \lambda I -A \right)  = P_{A} \left( \lambda \right).
      \end{aligned}
    \end{equation}
\end{proof}

相似变换对角化: 
如果矩阵$A_{m \times n}$有$n$个线性无关的特征向量,
\begin{equation}
  A x_i = \lambda_i x_i, \quad i = 1, 2, \cdots, n.
\end{equation}
那么存在一个相似矩阵$P$, 使得相似变换后的矩阵为对角矩阵$\Lambda = P ^{-1}AP$, $\Lambda$的对角元为特征值.

\begin{proof}
    把$A x_i = \lambda_i x_i$写成矩阵乘法的形式, 令$P = \begin{bmatrix} x_1, x_2, \cdots, x_n \end{bmatrix}$,
    \begin{equation}
      A \underbrace{\begin{bmatrix} x_1, x_2, \cdots, x_n \end{bmatrix}}_{P} = \underbrace{\begin{bmatrix} x_1, x_2, \cdots, x_n \end{bmatrix}}_{P} \underbrace{\begin{bmatrix} \lambda_1 & & & \\ & \lambda_2 & & \\ & & \ddots & \\ & & & \lambda_n \end{bmatrix}}_{\Lambda}.
    \end{equation}
    也就是说$\Lambda = P ^{-1} A P$.

    \textbf{反之}, 如果$A$可以相似对角化, 那么$A$有$n$个线性无关的特征向量, 特征值为矩阵的对角元素.
\end{proof}

\begin{example}
    对于矩阵$A = \begin{bmatrix}
     0 & 1\\
     0 & 0\\
    \end{bmatrix}$, 它不能相似对角化. 
\end{example}

\begin{theorem}
    一个特征值的几何重数小于等于它的代数重数.
\end{theorem}

\begin{proof}
    假设$\lambda$的特征向量的几何重数为$m$, 特征向量为$x_1,x_2,\cdots,x_m$, 且满足$A x_i = \lambda x_i$, $i = 1, 2, \cdots, m$.

    添加向量构造$\mathbb{R}^{n}$中的一组基$\left( x_1,x_2,\cdots,x_m, e_1,e_2,\cdots,e_{n-m} \right) $. 
    
    令$P = \begin{bmatrix} x_1,x_2,\cdots,x_m, e_1,e_2,\cdots,e_{n-m} \end{bmatrix}$, 把$Ax_i = \lambda_i x_i $写成矩阵乘法的形式
    \begin{equation}
        \begin{gathered}
            A \underbrace{\begin{bmatrix} x_1,x_2,\cdots,x_m, e_1,e_2,\cdots,e_{n-m} \end{bmatrix}}_{P} 
            \\
            =
            \underbrace{\begin{bmatrix} x_1,x_2,\cdots,x_m, e_1,e_2,\cdots,e_{n-m} \end{bmatrix}}_{P} 
            \underbrace{\left[ 
                \begin{array}{cccc|cc}
                    \lambda_1 &0 & \cdots& 0&* &* \\
                    0& \lambda_2 &\ddots & 0&* &* \\
                    0& 0& \ddots & 0&* &* \\
                    \vdots& \ddots&  0& \lambda_m &* &* \\
                    \hline
                    0& \ddots& &0 &*  &* \\
                    0& 0& \ddots & 0& *& * \\
                    0& 0&\cdots &0& *& * \\
                    \end{array}
             \right] 
            }_{C}.
        \end{gathered}
    \end{equation}
    因为$C$和$A$的特征多项式相同(由相似变换性质), 所以$C$至少有$m$个特征值 $\implies$ $A$至少有$m$个关于$\lambda$的特征值.
\end{proof}

不是每一个矩阵都可以相似对角化的, 但是每一个矩阵都可以相似上三角化. 即, 存在可逆矩阵$P$, 使得$P ^{-1} A P$为上三角矩阵, 且对角元为特征值.
\begin{proof}
    $A$一定有一个特征值$\lambda_1$和一个特征向量$v_1$, $A v_1 = \lambda_1 v_1$. 
    
    下一步添加向量构成一组基$\left( v_1,e_1,e_2,\cdots,e_{n-1} \right) $.
    令$P = \begin{bmatrix} v_1, e_1, e_2, \cdots, e_{n-1} \end{bmatrix}$, 把特征方程写成矩阵乘法的形式,
    \begin{equation}
      A \begin{bmatrix} v_1, e_1, e_2, \cdots, e_{n-1} \end{bmatrix} = \begin{bmatrix} v_1, e_1, e_2, \cdots, e_{n-1} \end{bmatrix} 
      \left[
        \begin{array}{c:ccc}
            \lambda_1 & \  & B_1 & \  \\
            \hdashline
            0 & & & \\
            \vdots & & A_1 & \\
            0 & & & \\
        \end{array} 
       \right] 
    \end{equation}

    之后再对子矩阵$A_1$做相同的操作.
\end{proof}